# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml


stages:
- stage: build_test
  displayName: Build, Test
  jobs:
  - job: windows_powershell_5_0
    displayName: '[Windows] PowerShell 5.0'
    pool:
      vmImage: vs2015-win2012r2
    steps:
    - checkout: self
      # submodules: true
    - powershell: |
        Get-PSDrive
        $PSVersionTable | Out-String
    - powershell: |
        $Erroractionpreference = 'stop'
        $_qAObject = New-Object -ComObject shell.application
        '1'
        try {
            $_qAItem = $_qAObject.Namespace("shell:::{679f85cb-0220-4080-b29b-5540cc05aab6}").Items() | Where-Object { $_.IsFolder -eq $true }
            '1'
        }catch {            
            $_ | select *
            $_.Exception | select *
            $_.Exception.Message
            $_.CategoryInfo.Category
            $_.CategoryInfo
        }
